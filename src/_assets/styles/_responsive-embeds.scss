$responsive-embeds-default-ratio: 1 !default;
$responsive-embeds-ratios:  "16-9" 16/9, "4-3" 4/3, "1-1" 1 !default;
$responsive-embeds-selector-prefix: ".embed--" !default;
$responsive-embeds-item-class: ".embed__media" !default;
$responsive-embeds-overflow: hidden !default;
$responsive-embeds-item-unknown-suffix: "unknown" !default;

// requirements
@mixin responsive-embeds-requirements(
  $item-class: $responsive-embeds-item-class,
  $overflow: $responsive-embeds-overflow
) {
  position: relative;
  overflow: $overflow;
  
  #{$item-class} {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  // img don't include height 100% to avoid weird images ratio
  // just in case
  img#{$item-class} { height: auto; }
}

%responsive-embeds {
  @include responsive-embeds-requirements;
}

// $ratio : any valid ratio like 16/9, 4/3...
@mixin responsive-embeds-item(
  $ratio: $responsive-embeds-default-ratio,
  $item-class: $responsive-embeds-item-class,
  $overflow: $responsive-embeds-overflow
) {
  // item will inherit from the placeholder if value are default ones
  @if ($item-class == $responsive-embeds-item-class and $overflow == $responsive-embeds-overflow) {
    @extend %responsive-embeds;
  }
  // otherwise, just include new value
  @else {
    @include responsive-embeds-requirements($item-class, $overflow);
  }
  padding-bottom: 100%/$ratio;
}

@mixin responsive-embeds-item-unknown(
  $selector-prefix: $responsive-embeds-selector-prefix,
  $item-class: $responsive-embeds-item-class,
  $item-unknown-suffix: $responsive-embeds-item-unknown-suffix
) {
  @if ($item-unknown-suffix != null) {
    #{$selector-prefix}#{$item-unknown-suffix} {
      text-align: center;
      
      #{$item-class} {
        display: inline-block;
        max-width: 100%;
      }
    }
  }
  
}

@mixin responsive-embeds(
  $ratios: $responsive-embeds-ratios,
  $selector-prefix: $responsive-embeds-selector-prefix,
  $item-class: $responsive-embeds-item-class,
  $item-unknown-suffix: $responsive-embeds-item-unknown-suffix
) {
  
  @include responsive-embeds-item-unknown($selector-prefix, $item-class, $item-unknown-suffix);
  
  @each $ratio in $ratios {
    @if (length($ratio)<2) {
      @warn "Responsive Embed ratio list should contain a list of 2 values (ratio name, for css selector & value for math)"
    }
    $selector-ratio: nth($ratio, 1);
    $ratio-value: nth($ratio, 2);
    $selector: unquote("#{$selector-prefix}#{$selector-ratio}");
    #{$selector} {
      @include responsive-embeds-item($ratio-value);
    }
  }
}

